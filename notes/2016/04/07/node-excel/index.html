<!DOCTYPE html><html lang="zh-cn" class="theme-o2 page-post-detail"><head prefix="og: http://ogp.me/ns#"><meta charset="utf-8"><title>Node读写Excel文件探究实践 | Aotu.io「凹凸实验室」</title><meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="apple-touch-fullscreen" content="yes"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><meta name="keywords" content="Node-Excel-Export,JS-XLSX,excel,node,凹凸实验室,Aotu,前端开发,全栈开发,IOS开发,Android开发"><link rel="canonical" href="http://aotu.io/notes/2016/04/07/node-excel/index.html"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/apple-touch-icon-57x57.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/apple-touch-icon-114x114.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/apple-touch-icon-72x72.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/apple-touch-icon-144x144.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/apple-touch-icon-60x60.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/apple-touch-icon-120x120.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/apple-touch-icon-76x76.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/apple-touch-icon-152x152.png"><link rel="icon" type="image/png" href="/assets/img/favicon-230x230.png" sizes="230x230"><link rel="icon" type="image/png" href="/assets/img/favicon-96x96.png" sizes="96x96"><link rel="icon" type="image/png" href="/assets/img/favicon-16x16.png" sizes="16x16"><link rel="icon" type="image/png" href="/assets/img/favicon-32x32.png" sizes="32x32"><meta name="msapplication-TileColor" content="#2f83cd"><meta name="msapplication-TileImage" content="/assets/img/mstile-144x144.png"><link rel="stylesheet" href="/assets/css/dist-c41d9f085d.o2.css"><link rel="stylesheet" href="/assets/fancybox/jquery.fancybox.css"><link rel="alternate" href="/atom.xml" title="Aotu.io「凹凸实验室」"><meta name="description" content="简介本文介绍用 Node.js 中的依赖库来处理 Excel 文件，深入分析对比常见npm库处理Excel 文件存在的优缺点，主要阐述用js-xlsx、excel-export 库来处理 Excel 文件。 
思路
有哪些外部模块支持读写Excel
引入依赖模块
编写业务逻辑函数
实践应用

支持读写Excel的node.js模块通过npm搜索，支持读写excel文件的模块有很多，但是都各有忧缺点"><meta property="og:type" content="article"><meta property="og:title" content="Node读写Excel文件探究实践"><meta property="og:url" content="http://aotu.io/notes/2016/04/07/node-excel/index.html"><meta property="og:site_name" content="Aotu.io「凹凸实验室」"><meta property="og:description" content="简介本文介绍用 Node.js 中的依赖库来处理 Excel 文件，深入分析对比常见npm库处理Excel 文件存在的优缺点，主要阐述用js-xlsx、excel-export 库来处理 Excel 文件。 
思路
有哪些外部模块支持读写Excel
引入依赖模块
编写业务逻辑函数
实践应用

支持读写Excel的node.js模块通过npm搜索，支持读写excel文件的模块有很多，但是都各有忧缺点"><meta property="og:updated_time" content="2016-04-07T06:05:44.000Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="Node读写Excel文件探究实践"><meta name="twitter:description" content="简介本文介绍用 Node.js 中的依赖库来处理 Excel 文件，深入分析对比常见npm库处理Excel 文件存在的优缺点，主要阐述用js-xlsx、excel-export 库来处理 Excel 文件。 
思路
有哪些外部模块支持读写Excel
引入依赖模块
编写业务逻辑函数
实践应用

支持读写Excel的node.js模块通过npm搜索，支持读写excel文件的模块有很多，但是都各有忧缺点"><meta name="twitter:site" content="o2circle"><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="//hm.baidu.com/hm.js?e850b980d029480b092fdd7503c3f8de";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><script>var App={root:"/"}</script><body itemscope itemtype="http://schema.org/WebPage"><div class="navbar navbar-fixed-top header" itemscope itemtype="http://schema.org/WPHeader"><div class="container"><div class="navbar-header"><a href="/index.html" title="Aotu.io「凹凸实验室」" class="navbar-brand"><img src="/assets/img/logo_186x65.png" alt="Aotu.io「凹凸实验室」"></a><div onclick="" class="navbar-toggle" data-toggle="collapse" data-target="#navbar-main"><span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span></div></div><div class="navbar-collapse collapse" id="navbar-main"><ul class="nav navbar-nav header-links header-links-main"><li class="main-nav-item"><a href="/index.html" class="main-nav-link">首页</a><li class="main-nav-item active"><a href="/notes/" class="main-nav-link">博客</a><li class="main-nav-item"><a href="/tags/" class="main-nav-link">标签</a><li class="main-nav-item"><a href="http://aotu.io/brand/" class="main-nav-link">品牌</a><li class="main-nav-item"><a href="/about/" class="main-nav-link">关于</a></ul><ul class="nav navbar-nav navbar-right header-links header-links-extra"><li class="search-wrap"><a class="fa fa-search search-icon" href="#search" title="搜索"></a><form id="search" method="get" class="search-form"><input type="text" name="query" class="search-form-ipt" placeholder="搜索"></form><li class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="javascript:;" id="themes" aria-expanded="false">主题&nbsp;<span class="caret"></span></a><ul id="theme-list" class="dropdown-menu" aria-labelledby="themes"><li data-v="light"><a href="javascript:;">曙光女神</a><li data-v="dark"><a href="javascript:;">暗影猎手</a></ul></ul></div></div></div><div class="container post-wrap"><article class="post" itemscope itemtype="http://schema.org/Article"><header class="post-header"><div class="post-title"><h2><a href="/notes/2016/04/07/node-excel/" itemprop="name">Node读写Excel文件探究实践</a></h2><ul class="post-stats"><li><a href="/tags/node/" class="meta-tag">node</a><li><a href="/tags/excel/" class="meta-tag">excel</a><li><a href="/tags/JS-XLSX/" class="meta-tag">JS-XLSX</a><li><a href="/tags/Node-Excel-Export/" class="meta-tag">Node-Excel-Export</a><li title="字数"><span class="icon fa-font">7,449</span><li id="busuanzi_container_page_pv" title="热度"><span class="icon fa-eye" id="busuanzi_value_page_pv"></span><li><a href="/notes/2016/04/07/node-excel/#comments" itemprop="discussionUrl" class="lnk-comments"><span class="post-comments-count ds-thread-count icon fa-comments" data-thread-key="bm90ZXMvMjAxNi8wNC8wNy9ub2RlLWV4Y2VsLw==" data-count-type="comments" itemprop="commentsCount">0</span></a></ul><p>本文介绍用 Node.js 中的依赖库来处理 Excel 文件，主要阐述用js-xlsx、excel-export 库来处理 Excel 文件。</div><div class="post-meta"><time class="published" datetime="2016-04-06T18:32:18.000Z" itempro="datePublished">星期三, 4月6日 2016</time> <a target="_blank" href="https://github.com/pfan123" class="author"><span class="name">高大师</span><img src="https://avatars.githubusercontent.com/pfan123?v=3&s=80" alt="pfan123"></a></div></header><a href="/notes/2016/04/07/node-excel/" class="image featured post-cover"><img src="/assets/img/post/pfan/excel/n_excel.png" alt="Node读写Excel文件探究实践"></a><div class="post-content" itemprop="articleBody" data-swiftype-index="true"><h2 id="简介" class="post-heading"><a href="#简介" class="headerlink" title="简介"></a>简介<a class="post-anchor" href="#简介" aria-hidden="true"></a></h2><p>本文介绍用 Node.js 中的依赖库来处理 Excel 文件，深入分析对比常见npm库处理Excel 文件存在的优缺点，主要阐述用js-xlsx、excel-export 库来处理 Excel 文件。<h2 id="思路" class="post-heading"><a href="#思路" class="headerlink" title="思路"></a>思路<a class="post-anchor" href="#思路" aria-hidden="true"></a></h2><ul><li>有哪些外部模块支持读写Excel<li>引入依赖模块<li>编写业务逻辑函数<li>实践应用</ul><h2 id="支持读写Excel的node-js模块" class="post-heading"><a href="#支持读写Excel的node-js模块" class="headerlink" title="支持读写Excel的node.js模块"></a>支持读写Excel的node.js模块<a class="post-anchor" href="#支持读写Excel的node-js模块" aria-hidden="true"></a></h2><p>通过npm搜索，支持读写excel文件的模块有很多，但是都各有忧缺点，有些仅支持xls/xlsx的一种格式，有些仅支持读取数据，有些仅支持导出文件，有些需要依赖python解析。常见的npm依赖模块如下：<blockquote><ul><li><a href="https://github.com/SheetJS/js-xlsx" target="_blank" rel="external">js-xlsx</a>: 目前 Github 上 star 数量最多的处理 Excel 的库，支持解析多种格式表格XLSX / XLSM / XLSB / XLS / CSV，解析采用纯js实现，写入需要依赖nodejs或者<a href="https://github.com/eligrey/FileSaver.js/" target="_blank" rel="external">FileSaver</a>.js实现生成写入Excel，可以生成子表Excel，功能强大，但上手难度稍大。不提供基础设置Excel表格api例单元格宽度，文档有些乱，不适合快速上手；<li><a href="https://github.com/mgcrea/node-xlsx" target="_blank" rel="external">node-xlsx</a>: 基于Node.js解析excel文件数据及生成excel文件，仅支持xlsx格式文件；<li><a href="https://github.com/leftshifters/excel-parser" target="_blank" rel="external">excel-parser</a>: 基于Node.js解析excel文件数据，支持xls及xlsx格式文件，需要依赖python，太重不太实用；<li><a href="https://github.com/functionscope/Node-Excel-Export" target="_blank" rel="external">excel-export</a> : 基于Node.js将数据生成导出excel文件，生成文件格式为xlsx，可以设置单元格宽度，API容易上手，无法生成worksheet字表，比较单一，基本功能可以基本满足；<li><a href="https://segmentfault.com/a/1190000004062768" target="_blank" rel="external">node-xlrd</a>: 基于node.js从excel文件中提取数据，仅支持xls格式文件,不支持xlsx,有点过时，常用的都是XLSX 格式。</ul></blockquote><p>通过以上分析对比，本人比较推崇<code>js-xlsx</code>、<code>excel-export</code>来读写Excel文件，可以结合使用<code>js-xlsx</code>解析Excel、<code>excel-export</code>生成，效果更加，接下来分别实践<code>js-xlsx</code>、<code>excel-export</code>。<h2 id="第一讲：利用-js-xlsx-处理-Excel-文件" class="post-heading"><a href="#第一讲：利用-js-xlsx-处理-Excel-文件" class="headerlink" title="第一讲：利用 js-xlsx 处理 Excel 文件"></a>第一讲：利用 js-xlsx 处理 Excel 文件<a class="post-anchor" href="#第一讲：利用-js-xlsx-处理-Excel-文件" aria-hidden="true"></a></h2><h3 id="安装" class="post-heading"><a href="#安装" class="headerlink" title="安装"></a>安装<a class="post-anchor" href="#安装" aria-hidden="true"></a></h3><p>node中使用通过npm：<br><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre><td class="code"><pre><span class="line">$ npm <span class="keyword">install</span> xlsx</span><br></pre></table></figure><p><p>浏览器使用：<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">lang</span>=<span class="string">"javascript"</span> <span class="attr">src</span>=<span class="string">"dist/xlsx.core.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></table></figure><p><p>通过bower安装：<br><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre><td class="code"><pre><span class="line"><span class="keyword">bower </span><span class="keyword">install </span><span class="keyword">js-xlsx</span></span><br></pre></table></figure><p><p><code>注意</code>，在客户端使用时，建议使用<code>dist/xlsx.full.min.js</code>，包含了js-xlsx所有模块。<h3 id="一些概念" class="post-heading"><a href="#一些概念" class="headerlink" title="一些概念"></a>一些概念<a class="post-anchor" href="#一些概念" aria-hidden="true"></a></h3><p>在使用这个库之前，先介绍库中的一些概念。<blockquote><ul><li>workbook 对象，指的是整份 Excel 文档。我们在使用 js-xlsx 读取 Excel 文档之后就会获得 workbook 对象。<li>worksheet 对象，指的是 Excel 文档中的表。我们知道一份 Excel 文档中可以包含很多张表，而每张表对应的就是 worksheet 对象。<li>cell 对象，指的就是 worksheet 中的单元格，一个单元格就是一个 cell 对象。</ul></blockquote><p>它们的关系如下：<br><figure class="highlight qml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre><td class="code"><pre><span class="line"><span class="comment">// workbook</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="attribute">SheetNames</span>: [<span class="string">'sheet1'</span>, <span class="string">'sheet2'</span>],</span><br><span class="line">    <span class="attribute">Sheets</span>: &#123;</span><br><span class="line">        <span class="comment">// worksheet</span></span><br><span class="line">        <span class="string">'sheet1'</span>: &#123;</span><br><span class="line">            <span class="comment">// cell</span></span><br><span class="line">            <span class="string">'A1'</span>: &#123; ... &#125;,</span><br><span class="line">            <span class="comment">// cell</span></span><br><span class="line">            <span class="string">'A2'</span>: &#123; ... &#125;,</span><br><span class="line">            ...</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="comment">// worksheet</span></span><br><span class="line">        <span class="string">'sheet2'</span>: &#123;</span><br><span class="line">            <span class="comment">// cell</span></span><br><span class="line">            <span class="string">'A1'</span>: &#123; ... &#125;,</span><br><span class="line">            <span class="comment">// cell</span></span><br><span class="line">            <span class="string">'A2'</span>: &#123; ... &#125;,</span><br><span class="line">            ...</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></table></figure><p><h3 id="用法" class="post-heading"><a href="#用法" class="headerlink" title="用法"></a>用法<a class="post-anchor" href="#用法" aria-hidden="true"></a></h3><p><strong>基本用法</strong><p>1.用 <code>XLSX.read</code> 读取获取到的 Excel 数据，返回 workbook<br>2.用 <code>XLSX.readFile</code> 打开 Excel 文件，返回 workbook<br>3.用 <code>workbook.SheetNames</code> 获取表名<br>4.用 <code>workbook.Sheets[xxx]</code> 通过表名获取表格<br>5.用 <code>worksheet[address]</code>操作单元格<br>6.用<code>XLSX.utils.sheet_to_json</code>针对单个表获取表格数据转换为json格式<br>7.用<code>XLSX.writeFile(wb, &#39;output.xlsx&#39;)</code>生成新的 Excel 文件<p><strong>具体用法</strong><br>读取 Excel 文件<br><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre><td class="code"><pre><span class="line"><span class="selector-tag">workbook</span> ＝ <span class="selector-tag">XLSX</span><span class="selector-class">.read</span>(excelData, &#123;<span class="attribute">type</span>: <span class="string">'base64'</span>&#125;);</span><br><span class="line"><span class="selector-tag">workbook</span> ＝ <span class="selector-tag">XLSX</span><span class="selector-class">.writeFile</span>(<span class="string">'someExcel.xlsx'</span>, opts);</span><br></pre></table></figure><p><p>获取 Excel 文件中的表<br><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre><td class="code"><pre><span class="line"><span class="comment">// 获取 Excel 中所有表名</span></span><br><span class="line"><span class="variable"><span class="keyword">var</span> sheetNames</span> = workbook.SheetNames; <span class="comment">// 返回 ['sheet1', 'sheet2',……]</span></span><br><span class="line"><span class="comment">// 根据表名获取对应某张表</span></span><br><span class="line"><span class="variable"><span class="keyword">var</span> worksheet</span> = workbook.Sheets[sheetNames[<span class="number">0</span>]];</span><br></pre></table></figure><p><p>通过 <code>worksheet[address]</code> 来操作表格，以 ! 开头的 key 是特殊的字段。<br><figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre><td class="code"><pre><span class="line">// 获取 A1 单元格对象</span><br><span class="line"><span class="keyword">let</span> a1 = worksheet[<span class="string">'A1'</span>]; // 返回 &#123; v: <span class="string">'hello'</span>, t: <span class="string">'s'</span>, ... &#125;</span><br><span class="line">// 获取 A1 中的值</span><br><span class="line">a1.v // 返回 <span class="string">'hello'</span></span><br><span class="line"></span><br><span class="line">// 获取表的有效范围</span><br><span class="line">worksheet[<span class="string">'!ref'</span>] // 返回 <span class="string">'A1:B20'</span></span><br><span class="line">worksheet[<span class="string">'!range'</span>] // 返回 range 对象，&#123; s: &#123; r: <span class="number">0</span>, c: <span class="number">0</span>&#125;, e: &#123; r: <span class="number">100</span>, c: <span class="number">2</span> &#125; &#125;</span><br><span class="line"></span><br><span class="line">// 获取合并过的单元格</span><br><span class="line">worksheet[<span class="string">'!merges'</span>] // 返回一个包含 range 对象的列表，[ &#123;s: &#123; r: <span class="number">0</span>, c: <span class="number">0</span> &#125;, c: &#123; r: <span class="number">2</span>, c: <span class="number">1</span> &#125; &#125; ]</span><br></pre></table></figure><p><p>获取 Excel 文件中的表转换为json数据<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre><td class="code"><pre><span class="line">XLSX<span class="selector-class">.utils</span><span class="selector-class">.sheet_to_json</span>(worksheet)  <span class="comment">//针对单个表，返回序列化json数据</span></span><br></pre></table></figure><p><p>生成新的 Excel 文件<br><figure class="highlight qml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre><td class="code"><pre><span class="line"><span class="comment">//服务端通过XLSX.writeFile</span></span><br><span class="line">XLSX = <span class="built_in">require</span>(<span class="string">"xlsx"</span>);</span><br><span class="line">XLSX.writeFile(wb, <span class="string">'output.xlsx'</span>)   </span><br><span class="line"></span><br><span class="line"><span class="comment">//客服端，只能通过XLSX.write(wb, write_opts) 写入 表格数据，借助FileSaver生成，且只支持在高版本浏览器。</span></span><br><span class="line"><span class="built_in">var</span> wopts = &#123; <span class="attribute">bookType</span>:<span class="string">'xlsx'</span>, <span class="attribute">bookSST</span>:<span class="attribute">false, type</span>:<span class="string">'binary'</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">var</span> wbout = XLSX.write(wb,wopts);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">s2ab</span>(<span class="params">s</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">var</span> buf = <span class="keyword">new</span> <span class="built_in">ArrayBuffer</span>(s.length);</span><br><span class="line">  <span class="built_in">var</span> view = <span class="keyword">new</span> <span class="built_in">Uint8Array</span>(buf);</span><br><span class="line">  <span class="keyword">for</span> (<span class="built_in">var</span> i=<span class="number">0</span>; i!=s.length; ++i) view[i] = s.charCodeAt(i) &amp; <span class="number">0xFF</span>;</span><br><span class="line">  <span class="keyword">return</span> buf;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* the saveAs call downloads a file on the local machine */</span></span><br><span class="line">saveAs(<span class="keyword">new</span> Blob([s2ab(wbout)],&#123;<span class="attribute">type</span>:<span class="string">""</span>&#125;), <span class="string">"test.xlsx"</span>)</span><br></pre></table></figure><p><h2 id="js-xlsx实战" class="post-heading"><a href="#js-xlsx实战" class="headerlink" title="js-xlsx实战"></a>js-xlsx实战<a class="post-anchor" href="#js-xlsx实战" aria-hidden="true"></a></h2><p><strong>解析 Excel 生成 JSON</strong><br><figure class="highlight nimrod"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre><td class="code"><pre><span class="line">function to_json(workbook) &#123;</span><br><span class="line">	<span class="keyword">var</span> <span class="literal">result</span> = &#123;&#125;;</span><br><span class="line"></span><br><span class="line">	// 获取 <span class="type">Excel</span> 中所有表名</span><br><span class="line">	<span class="keyword">var</span> sheetNames = workbook.<span class="type">SheetNames</span>; // 返回 ['sheet1', 'sheet2']</span><br><span class="line"></span><br><span class="line">	workbook.<span class="type">SheetNames</span>.forEach(function(sheetName) &#123;</span><br><span class="line">		<span class="keyword">var</span> worksheet = workbook.<span class="type">Sheets</span>[sheetName];</span><br><span class="line">		<span class="literal">result</span>[sheetName] = <span class="type">XLSX</span>.utils.sheet_to_json(worksheet);</span><br><span class="line">	&#125;);	</span><br><span class="line"></span><br><span class="line">	console.log(<span class="string">"打印表信息"</span>,<span class="type">JSON</span>.stringify(<span class="literal">result</span>, <span class="number">2</span>, <span class="number">2</span>));  //显示格式&#123;<span class="string">"表1"</span>:[],<span class="string">"表2"</span>:[]&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">result</span>;</span><br><span class="line">&#125;</span><br></pre></table></figure><p><p><strong>导出表格</strong><br>1.构建特定的数据结构，通过new Blob如下。<br><figure class="highlight qml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre><td class="code"><pre><span class="line"><span class="comment">// workbook</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="attribute">SheetNames</span>: [<span class="string">'mySheet'</span>],</span><br><span class="line">    <span class="attribute">Sheets</span>: &#123;</span><br><span class="line">        <span class="string">'mySheet'</span>: &#123;</span><br><span class="line">            <span class="string">'!ref'</span>: <span class="string">'A1:E4'</span>, <span class="comment">// 必须要有这个范围才能输出，否则导出的 excel 会是一个空表</span></span><br><span class="line">            <span class="attribute">A1</span>: &#123; <span class="attribute">v</span>: <span class="string">'id'</span> &#125;,</span><br><span class="line">            ...</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></table></figure><p><p>2.调用 XLSX.write， 借助FileSaver中new Blob生成即可。<br><figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br></pre><td class="code"><pre><span class="line">var _headers = [<span class="string">'id'</span>, <span class="string">'name'</span>, <span class="string">'age'</span>, <span class="string">'country'</span>, <span class="string">'remark'</span>]</span><br><span class="line">var _data = [ &#123; id: <span class="string">'1'</span>,</span><br><span class="line">                name: <span class="string">'test1'</span>,</span><br><span class="line">                age: <span class="string">'30'</span>,</span><br><span class="line">                country: <span class="string">'China'</span>,</span><br><span class="line">                remark: <span class="string">'hello'</span> &#125;,</span><br><span class="line">              &#123; id: <span class="string">'2'</span>,</span><br><span class="line">                name: <span class="string">'test2'</span>,</span><br><span class="line">                age: <span class="string">'20'</span>,</span><br><span class="line">                country: <span class="string">'America'</span>,</span><br><span class="line">                remark: <span class="string">'world'</span> &#125;,</span><br><span class="line">              &#123; id: <span class="string">'3'</span>,</span><br><span class="line">                name: <span class="string">'test3'</span>,</span><br><span class="line">                age: <span class="string">'18'</span>,</span><br><span class="line">                country: <span class="string">'Unkonw'</span>,</span><br><span class="line">                remark: <span class="string">'???'</span> &#125; ];</span><br><span class="line"></span><br><span class="line">var headers = _headers</span><br><span class="line">                // 为 _headers 添加对应的单元格位置</span><br><span class="line">                // [ &#123; v: <span class="string">'id'</span>, position: <span class="string">'A1'</span> &#125;,</span><br><span class="line">                //   &#123; v: <span class="string">'name'</span>, position: <span class="string">'B1'</span> &#125;,</span><br><span class="line">                //   &#123; v: <span class="string">'age'</span>, position: <span class="string">'C1'</span> &#125;,</span><br><span class="line">                //   &#123; v: <span class="string">'country'</span>, position: <span class="string">'D1'</span> &#125;,</span><br><span class="line">                //   &#123; v: <span class="string">'remark'</span>, position: <span class="string">'E1'</span> &#125; ]</span><br><span class="line">                .<span class="keyword">map</span>((v, i) =&gt; Object.assign(&#123;&#125;, &#123;v: v, position: String.fromCharCode(<span class="number">65</span>+i) + <span class="number">1</span> &#125;))</span><br><span class="line">                // 转换成 worksheet 需要的结构</span><br><span class="line">                // &#123; A1: &#123; v: <span class="string">'id'</span> &#125;,</span><br><span class="line">                //   B1: &#123; v: <span class="string">'name'</span> &#125;,</span><br><span class="line">                //   C1: &#123; v: <span class="string">'age'</span> &#125;,</span><br><span class="line">                //   D1: &#123; v: <span class="string">'country'</span> &#125;,</span><br><span class="line">                //   E1: &#123; v: <span class="string">'remark'</span> &#125; &#125;</span><br><span class="line">                .reduce((prev, <span class="keyword">next</span>) =&gt; Object.assign(&#123;&#125;, prev, &#123;[next.position]: &#123;v: next.v&#125;&#125;), &#123;&#125;);</span><br><span class="line"></span><br><span class="line">var data = _data</span><br><span class="line">              // 匹配 headers 的位置，生成对应的单元格数据</span><br><span class="line">              // [ [ &#123; v: <span class="string">'1'</span>, position: <span class="string">'A2'</span> &#125;,</span><br><span class="line">              //     &#123; v: <span class="string">'test1'</span>, position: <span class="string">'B2'</span> &#125;,</span><br><span class="line">              //     &#123; v: <span class="string">'30'</span>, position: <span class="string">'C2'</span> &#125;,</span><br><span class="line">              //     &#123; v: <span class="string">'China'</span>, position: <span class="string">'D2'</span> &#125;,</span><br><span class="line">              //     &#123; v: <span class="string">'hello'</span>, position: <span class="string">'E2'</span> &#125; ],</span><br><span class="line">              //   [ &#123; v: <span class="string">'2'</span>, position: <span class="string">'A3'</span> &#125;,</span><br><span class="line">              //     &#123; v: <span class="string">'test2'</span>, position: <span class="string">'B3'</span> &#125;,</span><br><span class="line">              //     &#123; v: <span class="string">'20'</span>, position: <span class="string">'C3'</span> &#125;,</span><br><span class="line">              //     &#123; v: <span class="string">'America'</span>, position: <span class="string">'D3'</span> &#125;,</span><br><span class="line">              //     &#123; v: <span class="string">'world'</span>, position: <span class="string">'E3'</span> &#125; ],</span><br><span class="line">              //   [ &#123; v: <span class="string">'3'</span>, position: <span class="string">'A4'</span> &#125;,</span><br><span class="line">              //     &#123; v: <span class="string">'test3'</span>, position: <span class="string">'B4'</span> &#125;,</span><br><span class="line">              //     &#123; v: <span class="string">'18'</span>, position: <span class="string">'C4'</span> &#125;,</span><br><span class="line">              //     &#123; v: <span class="string">'Unkonw'</span>, position: <span class="string">'D4'</span> &#125;,</span><br><span class="line">              //     &#123; v: <span class="string">'???'</span>, position: <span class="string">'E4'</span> &#125; ] ]</span><br><span class="line">              .<span class="keyword">map</span>((v, i) =&gt; _headers.<span class="keyword">map</span>((k, j) =&gt; Object.assign(&#123;&#125;, &#123; v: v[k], position: String.fromCharCode(<span class="number">65</span>+j) + (i+<span class="number">2</span>) &#125;)))</span><br><span class="line">              // 对刚才的结果进行降维处理（二维数组变成一维数组）</span><br><span class="line">              // [ &#123; v: <span class="string">'1'</span>, position: <span class="string">'A2'</span> &#125;,</span><br><span class="line">              //   &#123; v: <span class="string">'test1'</span>, position: <span class="string">'B2'</span> &#125;,</span><br><span class="line">              //   &#123; v: <span class="string">'30'</span>, position: <span class="string">'C2'</span> &#125;,</span><br><span class="line">              //   &#123; v: <span class="string">'China'</span>, position: <span class="string">'D2'</span> &#125;,</span><br><span class="line">              //   &#123; v: <span class="string">'hello'</span>, position: <span class="string">'E2'</span> &#125;,</span><br><span class="line">              //   &#123; v: <span class="string">'2'</span>, position: <span class="string">'A3'</span> &#125;,</span><br><span class="line">              //   &#123; v: <span class="string">'test2'</span>, position: <span class="string">'B3'</span> &#125;,</span><br><span class="line">              //   &#123; v: <span class="string">'20'</span>, position: <span class="string">'C3'</span> &#125;,</span><br><span class="line">              //   &#123; v: <span class="string">'America'</span>, position: <span class="string">'D3'</span> &#125;,</span><br><span class="line">              //   &#123; v: <span class="string">'world'</span>, position: <span class="string">'E3'</span> &#125;,</span><br><span class="line">              //   &#123; v: <span class="string">'3'</span>, position: <span class="string">'A4'</span> &#125;,</span><br><span class="line">              //   &#123; v: <span class="string">'test3'</span>, position: <span class="string">'B4'</span> &#125;,</span><br><span class="line">              //   &#123; v: <span class="string">'18'</span>, position: <span class="string">'C4'</span> &#125;,</span><br><span class="line">              //   &#123; v: <span class="string">'Unkonw'</span>, position: <span class="string">'D4'</span> &#125;,</span><br><span class="line">              //   &#123; v: <span class="string">'???'</span>, position: <span class="string">'E4'</span> &#125; ]</span><br><span class="line">              .reduce((prev, <span class="keyword">next</span>) =&gt; prev.concat(<span class="keyword">next</span>))</span><br><span class="line">              // 转换成 worksheet 需要的结构</span><br><span class="line">              //   &#123; A2: &#123; v: <span class="string">'1'</span> &#125;,</span><br><span class="line">              //     B2: &#123; v: <span class="string">'test1'</span> &#125;,</span><br><span class="line">              //     C2: &#123; v: <span class="string">'30'</span> &#125;,</span><br><span class="line">              //     D2: &#123; v: <span class="string">'China'</span> &#125;,</span><br><span class="line">              //     E2: &#123; v: <span class="string">'hello'</span> &#125;,</span><br><span class="line">              //     A3: &#123; v: <span class="string">'2'</span> &#125;,</span><br><span class="line">              //     B3: &#123; v: <span class="string">'test2'</span> &#125;,</span><br><span class="line">              //     C3: &#123; v: <span class="string">'20'</span> &#125;,</span><br><span class="line">              //     D3: &#123; v: <span class="string">'America'</span> &#125;,</span><br><span class="line">              //     E3: &#123; v: <span class="string">'world'</span> &#125;,</span><br><span class="line">              //     A4: &#123; v: <span class="string">'3'</span> &#125;,</span><br><span class="line">              //     B4: &#123; v: <span class="string">'test3'</span> &#125;,</span><br><span class="line">              //     C4: &#123; v: <span class="string">'18'</span> &#125;,</span><br><span class="line">              //     D4: &#123; v: <span class="string">'Unkonw'</span> &#125;,</span><br><span class="line">              //     E4: &#123; v: <span class="string">'???'</span> &#125; &#125;</span><br><span class="line">              .reduce((prev, <span class="keyword">next</span>) =&gt; Object.assign(&#123;&#125;, prev, &#123;[next.position]: &#123;v: next.v&#125;&#125;), &#123;&#125;);</span><br><span class="line"></span><br><span class="line">// 合并 headers 和 data</span><br><span class="line">var output = Object.assign(&#123;&#125;, headers, data);</span><br><span class="line">// 获取所有单元格的位置</span><br><span class="line">var outputPos = Object.keys(output);</span><br><span class="line">// 计算出范围</span><br><span class="line">var ref = outputPos[<span class="number">0</span>] + <span class="string">':'</span> + outputPos[outputPos.length - <span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">// 构建 workbook 对象</span><br><span class="line">var wb = &#123;</span><br><span class="line">    SheetNames: [<span class="string">'mySheet'</span>],</span><br><span class="line">    Sheets: &#123;</span><br><span class="line">        <span class="string">'mySheet'</span>: Object.assign(&#123;&#125;, output, &#123; <span class="string">'!ref'</span>: ref &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// 导出 Excel</span><br><span class="line">//XLSX.writeFile(wb, <span class="string">'output.xlsx'</span>);</span><br><span class="line"></span><br><span class="line">var wopts = &#123; bookType:<span class="string">'xlsx'</span>, bookSST:false, type:<span class="string">'binary'</span> &#125;;</span><br><span class="line"></span><br><span class="line">var wbout = XLSX.write(wb,wopts);</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> s2ab(s) &#123;</span><br><span class="line">  var buf = new ArrayBuffer(s.length);</span><br><span class="line">  var view = new Uint8Array(buf);</span><br><span class="line">  for (var i=<span class="number">0</span>; i!=s.length; ++i) view[i] = s.charCodeAt(i) &amp; <span class="number">0xFF</span>;</span><br><span class="line">  return buf;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/* the saveAs call downloads a file on the local machine */</span><br><span class="line">saveAs(new Blob([s2ab(wbout)],&#123;type:<span class="string">""</span>&#125;), <span class="string">"test.xlsx"</span>)</span><br></pre></table></figure><p><p>实践Demo：<a href="http://doc.pfan123.com/excel.html" target="_blank" rel="external">RD快速生成excel表</a><h2 id="第二讲：利用-excel-export-生成-Excel-文件" class="post-heading"><a href="#第二讲：利用-excel-export-生成-Excel-文件" class="headerlink" title="第二讲：利用 excel-export 生成 Excel 文件"></a>第二讲：利用 excel-export 生成 Excel 文件<a class="post-anchor" href="#第二讲：利用-excel-export-生成-Excel-文件" aria-hidden="true"></a></h2><p>excel-export模块，上手起来就比较容易了，其中原理是通过修改，修改header 信息、拼接字符串、修改字符集、输出字符串的形式实现的，在部分firefox低版本下载中文名会出现乱码情况。我们只需要按照API设置好数据参数，通过nodeExcel.execute调用执行，系统调用模版”styles.xml”就可以生成Excel文件，比较好的就是，它可以设置单元格的宽度，类型。<br>我们先看看，官方提供的例子：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre><td class="code"><pre><span class="line"><span class="keyword">var</span> express = <span class="built_in">require</span>(<span class="string">'express'</span>);</span><br><span class="line"><span class="keyword">var</span> nodeExcel = <span class="built_in">require</span>(<span class="string">'excel-export'</span>);</span><br><span class="line"><span class="keyword">var</span> app = express();</span><br><span class="line"></span><br><span class="line">app.get(<span class="string">'/Excel'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> conf =&#123;&#125;;</span><br><span class="line">    conf.stylesXmlFile = <span class="string">"styles.xml"</span>;</span><br><span class="line">    conf.name = <span class="string">"mysheet"</span>;</span><br><span class="line">    conf.cols = [&#123;</span><br><span class="line">        caption:<span class="string">'string'</span>,</span><br><span class="line">        type:<span class="string">'string'</span>,</span><br><span class="line">        beforeCellWrite:<span class="function"><span class="keyword">function</span>(<span class="params">row, cellData</span>)</span>&#123;</span><br><span class="line">             <span class="keyword">return</span> cellData.toUpperCase();</span><br><span class="line">        &#125;,</span><br><span class="line">        width:<span class="number">28.7109375</span></span><br><span class="line">    &#125;,&#123;</span><br><span class="line">        caption:<span class="string">'date'</span>,</span><br><span class="line">        type:<span class="string">'date'</span>,</span><br><span class="line">        beforeCellWrite:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="keyword">var</span> originDate = <span class="keyword">new</span> <span class="built_in">Date</span>(<span class="built_in">Date</span>.UTC(<span class="number">1899</span>,<span class="number">11</span>,<span class="number">30</span>));</span><br><span class="line">            <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">row, cellData, eOpt</span>)</span>&#123;</span><br><span class="line">                <span class="keyword">if</span> (eOpt.rowNum%<span class="number">2</span>)&#123;</span><br><span class="line">                    eOpt.styleIndex = <span class="number">1</span>;</span><br><span class="line">                &#125;  </span><br><span class="line">                <span class="keyword">else</span>&#123;</span><br><span class="line">                    eOpt.styleIndex = <span class="number">2</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (cellData === <span class="literal">null</span>)&#123;</span><br><span class="line">                  eOpt.cellType = <span class="string">'string'</span>;</span><br><span class="line">                  <span class="keyword">return</span> <span class="string">'N/A'</span>;</span><br><span class="line">                &#125; <span class="keyword">else</span></span><br><span class="line">                  <span class="keyword">return</span> (cellData - originDate) / (<span class="number">24</span> * <span class="number">60</span> * <span class="number">60</span> * <span class="number">1000</span>);</span><br><span class="line">            &#125; </span><br><span class="line">        &#125;()</span><br><span class="line">    &#125;,&#123;</span><br><span class="line">        caption:<span class="string">'bool'</span>,</span><br><span class="line">        type:<span class="string">'bool'</span></span><br><span class="line">    &#125;,&#123;</span><br><span class="line">        caption:<span class="string">'number'</span>,</span><br><span class="line">         type:<span class="string">'number'</span>              </span><br><span class="line">    &#125;];</span><br><span class="line">    conf.rows = [</span><br><span class="line">        [<span class="string">'pi'</span>, <span class="keyword">new</span> <span class="built_in">Date</span>(<span class="built_in">Date</span>.UTC(<span class="number">2013</span>, <span class="number">4</span>, <span class="number">1</span>)), <span class="literal">true</span>, <span class="number">3.14</span>],</span><br><span class="line">        [<span class="string">"e"</span>, <span class="keyword">new</span> <span class="built_in">Date</span>(<span class="number">2012</span>, <span class="number">4</span>, <span class="number">1</span>), <span class="literal">false</span>, <span class="number">2.7182</span>],</span><br><span class="line">        [<span class="string">"M&amp;M&lt;&gt;'"</span>, <span class="keyword">new</span> <span class="built_in">Date</span>(<span class="built_in">Date</span>.UTC(<span class="number">2013</span>, <span class="number">6</span>, <span class="number">9</span>)), <span class="literal">false</span>, <span class="number">1.61803</span>],</span><br><span class="line">        [<span class="string">"null date"</span>, <span class="literal">null</span>, <span class="literal">true</span>, <span class="number">1.414</span>]  </span><br><span class="line">    ];</span><br><span class="line">    <span class="keyword">var</span> result = nodeExcel.execute(conf);</span><br><span class="line">    res.setHeader(<span class="string">'Content-Type'</span>, <span class="string">'application/vnd.openxmlformats'</span>);</span><br><span class="line">    res.setHeader(<span class="string">"Content-Disposition"</span>, <span class="string">"attachment; filename="</span> + <span class="string">"Report.xlsx"</span>);</span><br><span class="line">    res.end(result, <span class="string">'binary'</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.listen(<span class="number">3000</span>);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'Listening on port 3000'</span>);</span><br></pre></table></figure><p><p><strong>分析生成excel流程：</strong><br>1.配置excel文件名conf.name<br>2.设置表caption，每列单元格数据类型，宽度<br>3.填充表中每行数据conf.rows，nodeExcel.execute生成数据结构，设置头部，拼接生成表<p><strong>写在最后，以上仅为个人观点，如有纰漏之处，欢迎各位大侠拍砖！</strong><p>参考资料：<ul><li><a href="https://github.com/functionscope/Node-Excel-Export" target="_blank" rel="external">Node-Excel-Export excel导出</a><li><a href="https://segmentfault.com/a/1190000004062768" target="_blank" rel="external">node.js读写excel文件</a><li><a href="http://www.uedsc.com/js-xlsx.html" target="_blank" rel="external">JS-XLSX读取和解析Excel表格文件(xls/xlsx)的JavaScript插件</a><li><a href="http://scarletsky.github.io/2016/01/30/nodejs-process-excel/" target="_blank" rel="external">在 Node.js 中利用 js-xlsx 处理 Excel 文件</a><li><a href="https://segmentfault.com/a/1190000004062768" target="_blank" rel="external">node-xlrd</a><li><a href="https://github.com/leftshifters/excel-parser" target="_blank" rel="external">excel-parser</a><li><a href="https://github.com/eligrey/FileSaver.js/" target="_blank" rel="external">FileSaver浏览器保存excel</a><li><a href="http://stackoverflow.com/questions/30859901/parse-xlsx-with-node-and-create-json" target="_blank" rel="external">stackoverflow xlsx相关问题</a></ul></div><div class="post-revision"><i class="fa fa-clock-o"></i> <time class="post-updated" datetime="2016-04-07T06:05:44.000Z" itemprop="dateModified">上次更新：星期四, 4月7日 2016 06:05:44</time></div><div class="actions pagination pagination-post"><div class="pagination-post-next"><a href="/notes/2016/03/31/readable/" class="button big" title="提升代码的可读性系列(一)--基础篇">提升代码的可读性系列(一)--基础篇 <i class="fa fa-chevron-right"></i></a></div></div><div class="post-comments" id="comments"><div class="ds-thread" data-thread-key="bm90ZXMvMjAxNi8wNC8wNy9ub2RlLWV4Y2VsLw==" data-title="Node读写Excel文件探究实践" data-url="http://aotu.io/notes/2016/04/07/node-excel/index.html"></div><script>var duoshuoQuery={short_name:"aotu"};!function(){var t=document.createElement("script");t.id="duoshuo-script",t.type="text/javascript",t.async=!0,t.src=("https:"==document.location.protocol?"https:":"http:")+"//static.duoshuo.com/embed.js",t.charset="UTF-8",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(t)}()</script></div></article></div><div class="sec sec-follow-lite"><div class="container"><div class="sec-heading"><p class="follow-pic"><img src="/assets/img/qrcode.png" alt="关注我们"><p class="follow-desc">海海人生，无折腾不为乐。<p class="sec-heading-sub follow-acount"><img class="follow-icon" src="/assets/img/logo-circle-120.png" alt="AOTULabs"> 微信号：AOTULabs</div></div></div><div class="sec sec-footer"><div class="container"><footer id="footer" class="sec-heading footer"><ul class="icons"><li><a href="https://twitter.com/o2circle" class="footer-link" target="_blank"><i class="fa fa-twitter"></i></a><li><a href="/atom.xml" class="footer-link fa-rss"><span class="label">RSS</span></a><li><a href="https://github.com/o2team/o2team.github.io" class="footer-link" target="_blank"><i class="fa fa-github-alt"></i></a></ul><div class="footer-sec copyright">&copy; 2016 <a href="http://aotu.io" target="_blank">凹凸实验室</a><br>Documentation licensed under <a href="http://creativecommons.org/licenses/by/4.0/" target="_blank">CC BY 4.0</a>.</div><div class="footer-sec words">" Nothing is difficult to the man who will try. "</div><div class="footer-sec site-stats" style="display:none"><span id="busuanzi_container_site_pv" class="site-pv">总访问量: <span id="busuanzi_value_site_pv" class="site-pv-num"></span> 次 </span><span id="busuanzi_container_site_uv" class="site-uv">总访客数: <span id="busuanzi_value_site_uv" class="site-uv-num"></span> 人</span></div></footer></div></div><section id="smSearch" class="slide-search"><section><form class="search" method="get"><input type="text" name="query" placeholder="搜索"></form></section><section><h3>搜索结果</h3><ul class="links" id="searchResults">Loading...</ul></section></section><script id="tplSearch" type="text/hogan-tpl">{{#items}}
    <li>
        <a href="{{ url }}" target="_blank">
            <h3>{{ title }}</h3>
            {{#desc}}
			<p>{{ desc }}</p>
			{{/desc}}
        </a>
    </li>
    {{/items}}</script><div class="back-to-top" id="backTop"><i class="fa fa-long-arrow-up"></i></div><script src="/assets/js/dist-da107fe6a1.o2.js"></script><script src="/assets/js/dist-bb2f97f6a9.duoshuo.js"></script><script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>!function(){var e=document.createElement("script");e.src="//push.zhanzhang.baidu.com/push.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script>